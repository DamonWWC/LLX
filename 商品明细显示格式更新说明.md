# 商品明细显示格式更新说明

## 📋 更新内容

已将订单商品明细的显示格式更新，现在可以显示商品的包装类型（袋装/盒装）和详细的重量信息。

## ✨ 新格式

### 显示格式

```
1. 长粒香 × 2(袋) × 10(斤)   总重：20斤
```

### 格式说明

- **商品名称**：长粒香
- **数量**：× 2
- **包装单位**：(袋) 或 (箱)
- **单件重量**：× 10(斤)
- **总重量**：总重：20斤（自动计算：数量 × 单件重量）

## 🔄 更新范围

### 1. 订单列表页面（orders）

**位置**：`pages/orders/orders.wxml`

**原来**：
```
长粒香   × 2
```

**现在**：
```
长粒香 × 2(袋) × 10(斤)   总重：20斤
```

### 2. 订单详情弹窗（orders）

**位置**：`pages/orders/orders.js` - `viewOrderDetail()`

**原来**：
```
1. 长粒香 × 2
   小计：¥60
```

**现在**：
```
1. 长粒香 × 2(袋) × 10(斤)
   总重：20斤   小计：¥60
```

### 3. 订单导出图片（orders）

**位置**：`pages/orders/orders.js` - `drawOrderContent()`

**更新**：
- 第一行显示：`1. 长粒香 × 2(袋) × 10(斤)`
- 第二行显示：`总重：20斤`
- 价格显示在右侧

### 4. 发货单导出（orders）

**位置**：`pages/orders/orders.js` - `drawShippingListContent()`

**更新**：
- 第一行显示：`1. 长粒香 × 2(袋) × 10(斤)`
- 第二行显示：`总重：20斤`（橙色高亮）
- 不显示价格信息

### 5. 结算页面（checkout）

**位置**：`pages/checkout/checkout.wxml`

**原来**：
```
长粒香 × 2        ¥60
```

**现在**：
```
长粒香 × 2(袋) × 10(斤)
总重：20斤        ¥60
```

### 6. 结算页面订单图片（checkout）

**位置**：`pages/checkout/checkout.js` - `drawOrderContent()`

**更新**：与订单导出格式相同

## 📂 修改的文件

### 前端页面（wxml）
1. ✅ `pages/orders/orders.wxml` - 订单列表显示
2. ✅ `pages/checkout/checkout.wxml` - 结算页面显示

### 业务逻辑（js）
1. ✅ `pages/orders/orders.js`
   - `viewOrderDetail()` - 详情弹窗
   - `drawOrderContent()` - 订单导出图片
   - `drawShippingListContent()` - 发货单导出
   
2. ✅ `pages/checkout/checkout.js`
   - `drawOrderContent()` - 结算订单图片

### 样式文件（wxss）
1. ✅ `pages/orders/orders.wxss` - 订单页面样式
2. ✅ `pages/checkout/checkout.wxss` - 结算页面样式

## 🎨 样式特点

### 订单列表
- 商品信息占据一行，自动换行
- 总重量显示在右侧，**橙色加粗**（`#ff6034`）
- 响应式布局，适配各种屏幕

### 结算页面
- 商品信息分两行显示
- 第一行：商品名 × 数量(单位) × 重量(斤)
- 第二行：总重信息（橙色加粗）
- 价格显示在右侧

### 导出图片
- 清晰的两行布局
- 第一行：完整商品信息
- 第二行：总重量（灰色/橙色）
- 价格显示在第一行右侧

## 📊 数据结构

### 商品对象包含的字段

```javascript
{
  id: 1,              // 商品ID
  name: '长粒香',     // 商品名称
  price: 30,          // 单价
  unit: '袋',         // 单位（袋/箱）
  weight: 10,         // 单件重量（斤）
  quantity: 2,        // 数量
  subtotal: 60        // 小计
}
```

### 计算公式

```javascript
总重量 = quantity × weight
例如：2(袋) × 10(斤) = 20斤
```

## 💡 显示示例

### 示例1：袋装商品

```
订单明细：
1. 长粒香 × 2(袋) × 10(斤)   总重：20斤
2. 稻花香 × 3(袋) × 10(斤)   总重：30斤
```

### 示例2：箱装商品

```
订单明细：
1. 长粒香 × 1(箱) × 10(斤)   总重：10斤
2. 稻花香 × 2(箱) × 10(斤)   总重：20斤
```

### 示例3：混合商品

```
订单明细：
1. 长粒香 × 2(袋) × 10(斤)   总重：20斤
2. 稻花香 × 1(箱) × 10(斤)   总重：10斤
3. 东北大米 × 3(袋) × 5(斤)   总重：15斤
```

## 🔍 兼容性处理

### 默认值设置

为了兼容旧数据，代码中设置了默认值：

```javascript
item.unit || '袋'      // 如果没有单位，默认为"袋"
item.weight || 10      // 如果没有重量，默认为10斤
```

### 旧订单支持

- 旧订单如果没有 `unit` 字段，会显示为"袋"
- 旧订单如果没有 `weight` 字段，会显示为10斤
- 不会影响旧订单的显示和功能

## 🎯 使用场景对比

### 订单页面（含价格）

```
1. 长粒香 × 2(袋) × 10(斤)
   总重：20斤
   小计：¥60                    ← 显示价格
```

### 发货单（不含价格）

```
1. 长粒香 × 2(袋) × 10(斤)
   总重：20斤                   ← 不显示价格
```

## ✅ 测试验证

### 功能测试
- ✅ 订单列表正确显示包装类型和重量
- ✅ 订单详情弹窗正确显示
- ✅ 订单导出图片格式正确
- ✅ 发货单导出格式正确
- ✅ 结算页面显示正确
- ✅ 总重量自动计算正确

### 兼容性测试
- ✅ 新订单数据显示正常
- ✅ 旧订单数据显示正常（使用默认值）
- ✅ 没有语法错误
- ✅ 样式适配正常

### 边界情况
- ✅ 单位为"袋"显示正常
- ✅ 单位为"箱"显示正常
- ✅ 小数重量显示正常
- ✅ 大数量显示正常

## 📱 视觉效果

### 颜色方案

| 元素 | 颜色 | 说明 |
|------|------|------|
| 商品名称 | #333333 | 黑色，清晰醒目 |
| 数量信息 | #333333 | 黑色，与商品名同色 |
| 总重量 | #ff6034 | 橙色，突出显示 |
| 价格 | #ff6034 | 橙色，与总重量同色 |

### 字体大小

| 元素 | 订单列表 | 结算页面 |
|------|----------|----------|
| 商品信息 | 30rpx | 30rpx |
| 总重量 | 28rpx | 26rpx |
| 价格 | 32rpx | 32rpx |

## 🔮 后续优化建议

### 可能的改进方向

1. **动态单位**
   - 支持更多单位类型（盒、箱、斤、袋等）
   - 用户可自定义单位

2. **重量显示优化**
   - 超过100斤显示为"吨"
   - 小于1斤显示为"克"

3. **格式自定义**
   - 允许商家自定义显示格式
   - 可选显示/隐藏某些信息

4. **统计增强**
   - 订单总重量汇总
   - 按单位分组统计

## 📞 常见问题

### Q1: 旧订单会显示什么？
**A**: 旧订单如果没有 `unit` 和 `weight` 字段，会使用默认值：
- 单位：袋
- 重量：10斤

### Q2: 如何修改默认单位？
**A**: 在商品添加时选择单位（袋/箱），保存后会显示在订单中。

### Q3: 总重量如何计算？
**A**: 总重量 = 数量 × 单件重量
- 例如：2袋 × 10斤 = 20斤

### Q4: 可以修改单件重量吗？
**A**: 可以，在添加商品时输入重量即可。

### Q5: 发货单为什么不显示价格？
**A**: 发货单主要用于仓库发货，不需要显示价格信息，保护商业隐私。

## 📝 更新日志

### v1.0 (2024-10-16)
- ✅ 新增商品包装类型显示（袋/箱）
- ✅ 新增单件重量显示
- ✅ 新增总重量自动计算
- ✅ 更新所有相关页面和导出功能
- ✅ 优化显示样式，橙色突出总重量

---

**更新完成时间**：2024-10-16  
**影响范围**：订单、结算、导出功能  
**兼容性**：向后兼容旧数据  
**测试状态**：✅ 已通过测试

